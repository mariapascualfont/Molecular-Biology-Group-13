For homology based methods, we work with databases of known proteins and find alignments within them. 

Part A: Homology-based annotation

1. Find annotations from related species:
Perform blastx search of the contig_13 sequence against the nr database, using the official website:  https://blast.ncbi.nlm.nih.gov/Blast.cgi
We saw different proteins in the table of blast and decided to keep the following proteins:

- superoxide dismutase [Cu-Zn] [Danio aesculapii] 	
- superoxide dismutase [Cu-Zn] [Danio rerio] 	
- superoxide dismutase [Cu-Zn] [Paramisgurnus dabryanus] 	
- Cu/Zn-superoxide dismutase [Hemibarbus mylodon] 

And so, from the following species: Danio aesculapii, Danio rerio, Paramisgurnus dabryanus, Hemybarbus mylodon.
We realized there were some proteins named "hypothetical protein" but we decided not to use it because we don't know what codes for and don't know the function. It was better to use the superoxide dismutases, as we got similarities from different species of fish. We also noticed that though the similarity was high, of 81-93%, the query cover (the percentage of sequence that was coinciding) was quite low, around 10 %. That might mean that this 10% is the coding region of the sequence contig_13.
We then saved one of the matching proteins into a text file (fasta format).

2. Predict gene using Exonerate:
We aligned the protein to the DNA sequence:

1) The first alignment is with superoxide dismutase [Cu-Zn] [Danio aesculapii] led us to this information: 

- It aligns the protein XP_056323559.1 with de contig_13. It detects a gene between the positions 285 and 5033 en the DNA. (It is long) 
- The orientation is inverse(-), in the complementary strand.
- The protein aligns in a 98.68% of identity and 99.34% of similitude, that is a good coincidence.
- There are 5 exons which all have 100% identity but one that has 93.55%. And 4 introns.

2) The second alignment is with superoxide dismutase [Cu-Zn] [Dani rerio]:
- It aligns in reverse (complementary) orientation contig_13 with protein NP_571369.1, gene between 285 and 5033 on target gene (contig_13)
- the protein aligns with a 100 % identity (each nucleobase/ amino acid alignment-pair is a match and therefore also 100 % similarity)
- there are four introns and five exons

3) The third aligment is with superoxide dismutase [Cu-Zn] [Paramisgurnus dabryanus]:

3. Select only exon features:

1) Danio aesculapii:
contig_13	exonerate:protein2genome:local	exon	4962	5033	.	-	.	insertions 0 ; deletions 0 ; identity 100.00 ; similarity 100.00
contig_13	exonerate:protein2genome:local	exon	3308	3404	.	-	.	insertions 3 ; deletions 0 ; identity 93.55 ; similarity 96.77
contig_13	exonerate:protein2genome:local	exon	2699	2768	.	-	.	insertions 0 ; deletions 0 ; identity 100.00 ; similarity 100.00
contig_13	exonerate:protein2genome:local	exon	478	595	.	-	.	insertions 0 ; deletions 0 ; identity 100.00 ; similarity 100.00
contig_13	exonerate:protein2genome:local	exon	285	389	.	-	.	insertions 0 ; deletions 0 ; identity 100.00 ; similarity 100.00

2) Danio rerio:
contig_13.fa -S F| egrep -w exon > Zebrafish.exonerate.gff

contig_13	exonerate:protein2genome:local	exon	4962	5033	.	-	.	insertions 0 ; deletions 0 ; identity 100.00 ; similarity 100.00
contig_13	exonerate:protein2genome:local	exon	3308	3404	.	-	.	insertions 0 ; deletions 0 ; identity 100.00 ; similarity 100.00
contig_13	exonerate:protein2genome:local	exon	2699	2768	.	-	.	insertions 0 ; deletions 0 ; identity 100.00 ; similarity 100.00
contig_13	exonerate:protein2genome:local	exon	478	595	.	-	.	insertions 0 ; deletions 0 ; identity 100.00 ; similarity 100.00
contig_13	exonerate:protein2genome:local	exon	285	389	.	-	.	insertions 0 ; deletions 0 ; identity 100.00 ; similarity 100.00

3) Paramisgurnus dabryanus:


4.Extract exon sequences to store them in new fasta file:

We tried to use bedtools to get this exons in fasta format. We could also copy it directly from the terminal.

1)Danio aesculapii:
>contig_13:4961-5033
GACGCGC
GCGCTGCTCTCCTGCTACATGAACGTCATTTCAAATATGGATCAAAACAGACATTTTTTACCTC
>contig_13:3307-3404
GTGGGCCATAATAATCGCTAAATGTTCA
GTTTGACCACTCCTTACCGTTTGTGTTGTCACCAAAAGCATGGACGTGGAAACCATGTTTTCCTGGAG
>contig_13:2698-2768
TGCAAAACAGATGTATCAGAGCACACTGATAAACTCACCTCACACTATCGGTTGGCCCACCATGAGTTTT
>contig_13:477-595
CCTTACCACCATGGTCCTC
CCAATAATAGAATGTTGGCCTGACAGAGTCAGCATTGCATCCTCGATTTCAATTTTTGCAACACCACTGG
CATCAGCGGTCACATTACCCAGGTCTC
>contig_13:284-389
TTCACTGAGTGATGCCGATCACTCCACAGGCCAGACGACCACCAGCGTTGCCAGTTTTAAGACTTTCCTC
ATTGCCACCCTTCCCCAAGTCATCCTCCTTCTCA

2) Danio rerio:
>contig_13:4961-5033
CTCTTGATTGAAATAGACGGTGCCGGTCACTTCACCGGTGCCTTTAAGCACACAAACGGCCTTGTTCACCAT
>contig_13:3307-3404
CGTTTGTGTTGTCACCAAAAGCATGGACGTGGAAACCATGTTTTCCTGGAGTAAGGCCAGTAATTTCACCAGTCACCTTGACTGGCTTCTTTTCACC
>contig_13:2698-2768
CTCACACTATCGGTTGGCCCACCATGAGTTTTGTCATGAGGGTTGAAGTGCGGACCTGCACTGATGCAGC
>contig_13:477-595
CACCATGGTCCTCCCAATAATAGAATGTTGGCCTGACAGAGTCAGCATTGCATCCTCGATTTCAATTTTTGCAACACCACTGGCATCAGCGGTCACATTACCCAGGTCTCCGACGTGT
>contig_13:284-389
CTGAGTGATGCCGATCACTCCACAGGCCAGACGACCACCAGCGTTGCCAGTTTTAAGACTTTCCTCATTGCCACCCTTCCCCAAGTCATCCTCCTTCTCATGAAT

3) Paramisgurnus dabryanus:


5.Concatente exons into a single sequence:

1) Danio aesculapii:
>contig_13:4961-5033
GACGCGC
GCGCTGCTCTCCTGCTACATGAACGTCATTTCAAATATGGATCAAAACAGACATTTTTTACCTC
GTGGGCCATAATAATCGCTAAATGTTCA
GTTTGACCACTCCTTACCGTTTGTGTTGTCACCAAAAGCATGGACGTGGAAACCATGTTTTCCTGGAG
TGCAAAACAGATGTATCAGAGCACACTGATAAACTCACCTCACACTATCGGTTGGCCCACCATGAGTTTT
CCTTACCACCATGGTCCTC
CCAATAATAGAATGTTGGCCTGACAGAGTCAGCATTGCATCCTCGATTTCAATTTTTGCAACACCACTGG
CATCAGCGGTCACATTACCCAGGTCTC
TTCACTGAGTGATGCCGATCACTCCACAGGCCAGACGACCACCAGCGTTGCCAGTTTTAAGACTTTCCTC
ATTGCCACCCTTCCCCAAGTCATCCTCCTTCTCA

2) Danio rerio:
>contig_13:4961-5033
CTCTTGATTGAAATAGACGGTGCCGGTCACTTCACCGGTGCCTTTAAGCACACAAACGGCCTTGTTCACCAT
CGTTTGTGTTGTCACCAAAAGCATGGACGTGGAAACCATGTTTTCCTGGAGTAAGGCCAGTAATTTCACCAGTCACCTTGACTGGCTTCTTTTCACC
CTCACACTATCGGTTGGCCCACCATGAGTTTTGTCATGAGGGTTGAAGTGCGGACCTGCACTGATGCAGC
CACCATGGTCCTCCCAATAATAGAATGTTGGCCTGACAGAGTCAGCATTGCATCCTCGATTTCAATTTTTGCAACACCACTGGCATCAGCGGTCACATTACCCAGGTCTCCGACGTGT
CTGAGTGATGCCGATCACTCCACAGGCCAGACGACCACCAGCGTTGCCAGTTTTAAGACTTTCCTCATTGCCACCCTTCCCCAAGTCATCCTCCTTCTCATGAAT

3) Paramisgurnus dabryanus:

6.Compare homology-based and ab-initio predictions:


Part B: Functional Annotation

1. Search information in Gene Ontology (GO):
https://geneontology.org
  -Check if have associated ontology terms(molecular function, biological process, cellular component).

2. Search information in UniProt:
https://www.uniprot.org
   -Collect information, descriptions and synonyms.

3. Analyzse conserved domains with InterProScan:
   -Upload the gene sequence to https://www.ebi.ac.uk/interpro/search/sequence/
- Review the protein domains found, conserved motifs, and associated functions.
-Use the new information to improve searches in Gene Ontology.






